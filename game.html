<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gurjot's Games â€” Game</title>
    <meta name="description" content="Unified game shell for Gurjot's Games." />

    <!-- Import map resolves bare specifiers BEFORE any module loads -->
    <script type="importmap">
    {
      "imports": {
        "console-signature": "/js/vendor/console-signature.js",
        "three": "https://unpkg.com/three@0.161.0/build/three.module.js"
      }
    }
    </script>

    <style>
      html, body { height: 100%; margin: 0; background:#0c1222; color:#e6ecff; }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
      #hud { position: fixed; top: 10px; right: 10px; display: flex; gap: 8px; align-items: center; z-index: 10; }
      #score { min-width: 80px; text-align: right; }
      #pause-btn { padding: 6px 10px; border-radius: 10px; border: 1px solid rgba(255,255,255,.2); background: rgba(255,255,255,.06); color: inherit; }
      canvas { max-width: 100%; height: auto; background:#000; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,.5); }
      main { display:grid; place-items:center; min-height: 100vh; padding: 12px; }
    </style>
  </head>
  <body>
    <div id="hud" role="region" aria-label="Game HUD">
      <div id="score" aria-live="polite">0</div>
      <button id="pause-btn" aria-pressed="false" title="Pause/Resume">Pause</button>
    </div>

    <main>
      <!-- default canvas; games may use their own, but this prevents null getContext -->
      <canvas id="game-canvas" width="800" height="600" aria-label="Game canvas"></canvas>
    </main>

    <!-- 1) GG bootstrap (must be before any per-game code) -->
    <script src="/js/bootstrap/gg.js"></script>

    <!-- 2) Common DOM nodes & canvases -->
    <script src="/js/preflight.js"></script>

    <!-- 3) THREE global (legacy scripts like Maze 3D expect window.THREE) -->
    <script type="module" src="/js/three-global-shim.js"></script>

    <!-- 4) Ensure specific nodes; runs after DOM ready -->
    <script type="module">
      import { ensureCanvas, ensureElement } from "/js/bootstrap/dom.js";
      window.addEventListener("DOMContentLoaded", () => {
        ensureCanvas("game-canvas");
        ensureElement("#score");
        // Optional: mirror pause button state
        const btn = document.getElementById('pause-btn');
        const setPaused = (p) => { btn.setAttribute('aria-pressed', String(p)); btn.textContent = p ? "Resume" : "Pause"; };
        btn.addEventListener('click', () => setPaused(btn.getAttribute('aria-pressed') === 'true' ? false : true));
      });
    </script>

    <!-- 5) Your per-game script(s) go below this line.
         Example (Pong):
         <script type="module" src="/games/pong/main.js"></script>
    -->
  </body>
</html>
