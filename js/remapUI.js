(function(){const ACT={global:['PAUSE'],pong:['P1_UP','P1_DOWN','P2_UP','P2_DOWN','LAUNCH'],tetris:['LEFT','RIGHT','DOWN','ROTATE','HOLD','DROP','PAUSE'],snake:['LEFT','RIGHT','UP','DOWN','PAUSE'],breakout:['LEFT','RIGHT','LAUNCH','PAUSE'],chess:['PAUSE'],g2048:['LEFT','RIGHT','UP','DOWN','PAUSE']};let ov=null,wait=null,prof='global';function open(){if(ov)return;ov=document.createElement('div');Object.assign(ov.style,{position:'fixed',inset:0,background:'rgba(0,0,0,0.6)',backdropFilter:'blur(3px)',zIndex:10000,display:'flex',alignItems:'center',justifyContent:'center'});ov.innerHTML=`<div style="background:#0b1220;border:1px solid #243047;border-radius:16px;padding:16px 18px;color:#e6e7ea;min-width:320px;max-width:520px;font:14px/1.45 Inter,system-ui;"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;"><h3 style="margin:0;font-size:16px;">Controls</h3><div><select id="profileSel" style="background:#0f172a;color:#e5e7eb;border:1px solid #334155;border-radius:8px;padding:6px 8px;"><option>global</option><option>pong</option><option>tetris</option><option>snake</option><option>breakout</option><option>chess</option><option>g2048</option></select><button id="resetBtn" style="margin-left:8px;border:1px solid #374151;background:#111827;color:#e5e7eb;border-radius:8px;padding:6px 10px;cursor:pointer;">Reset</button><button id="closeBtn" style="margin-left:6px;border:1px solid #374151;background:#111827;color:#e5e7eb;border-radius:8px;padding:6px 10px;cursor:pointer;">Close</button></div></div><div id="bindings"></div><small style="opacity:.7;display:block;margin-top:8px;">Press a button to change its binding. F1 opens this panel.</small></div>`;document.body.appendChild(ov);const sel=ov.querySelector('#profileSel');sel.value=prof;sel.onchange=e=>{prof=e.target.value;render();};ov.querySelector('#resetBtn').onclick=()=>{Input.reset();render();};ov.querySelector('#closeBtn').onclick=close;render();window.addEventListener('keydown',capture,true);}function close(){if(!ov)return;window.removeEventListener('keydown',capture,true);ov.remove();ov=null;wait=null;}function capture(e){if(!wait)return;if(e._synthetic)return;e.preventDefault();e.stopPropagation();Input.setKey(prof,wait,e.key);wait=null;render();}function render(){const wrap=ov.querySelector('#bindings');const cfg=Input.config[prof];wrap.innerHTML='';(ACT[prof]||[]).forEach(act=>{const row=document.createElement('div');Object.assign(row.style,{display:'flex',justifyContent:'space-between',alignItems:'center',padding:'6px 0',gap:'10px'});const l=document.createElement('div');l.textContent=act;l.style.opacity=.9;const b=document.createElement('button');b.textContent=(cfg[act]||'â€”');Object.assign(b.style,{border:'1px solid #374151',background:'#111827',color:'#e5e7eb',borderRadius:'8px',padding:'6px 10px',cursor:'pointer'});b.onclick=()=>{wait=act;b.textContent='Press any key...';};row.append(l,b);wrap.appendChild(row);});}document.addEventListener('keydown',e=>{if(e.key==='F1'){e.preventDefault();open();}});window.openControlsModal=open;})();