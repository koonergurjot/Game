<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Chess (2D) â€” Gurjot's Games</title>
    <link rel="stylesheet" href="../../css/styles.css?v=5.3" />
    <script type="importmap">
    {
      "imports": {
        "console-signature": "/js/vendor/console-signature.js",
        "three": "https://unpkg.com/three@0.161.0/build/three.module.js"
      }
    }
    </script>
  </head>
  <body style="margin:0;background:#0b1220;color:#e6e7ea;">
    <main style="display:flex;gap:16px;justify-content:center;align-items:flex-start;padding:16px 16px 80px;">
      <div style="position:relative;">
        <canvas
          id="board"
          width="480"
          height="480"
          aria-label="Chess board"
          style="border:1px solid #243047;border-radius:12px;background:#0f172a;"
        ></canvas>
        <canvas
          id="fx"
          width="480"
          height="480"
          aria-hidden="true"
          style="position:absolute;left:0;top:0;pointer-events:none;"
        ></canvas>
      </div>
      <aside style="max-width:260px;">
        <h1 style="margin:0 0 8px 0;font-size:1.5rem;">Chess</h1>
        <p style="margin:0 0 12px;">
          Click a piece, then a target square.<br />
          Press <b>R</b> to restart.<br />
          Press <b>F1</b> for control remap.
        </p>
        <label for="difficulty">Difficulty:</label>
        <select id="difficulty" style="display:block;margin:4px 0 12px;">
          <option value="1">Easy</option>
          <option value="2" selected>Medium</option>
          <option value="3">Hard</option>
          <option value="4">Expert</option>
        </select>
        <label for="puzzle-select">Puzzles:</label>
        <select id="puzzle-select" style="display:block;margin:4px 0 12px;">
          <option value="-1">Free Play</option>
        </select>
        <div id="status" role="status" aria-live="polite" style="min-height:1.5em;"></div>
        <section id="lobby" aria-label="Online play" style="margin-top:16px;">
          <button id="find-match" type="button">Find Match</button>
          <div id="lobby-status" style="min-height:1.5em;"></div>
          <ol id="rankings"></ol>
        </section>
      </aside>
    </main>
    <script src="../../js/bootstrap/gg.js"></script>
    <script src="../../js/preflight.js"></script>
    <script type="module" src="../../js/three-global-shim.js"></script>
    <script type="module">
      import { ensureCanvas, ensureElement } from "../../js/bootstrap/dom.js";
      window.addEventListener("DOMContentLoaded", () => {
        ensureCanvas("board");
        ensureCanvas("fx");
        ensureElement("#status");
        ensureElement("#difficulty");
        ensureElement("#puzzle-select");
        ensureElement("#lobby");
        ensureElement("#lobby-status");
        ensureElement("#rankings");
        ensureElement("#find-match");
      });
    </script>
    <script src="../../games/chess/ai.js?v=5.3"></script>
    <script src="../../games/chess/puzzles.js?v=5.3"></script>
    <script src="../../games/chess/ratings.js?v=5.3"></script>
    <script src="../../games/chess/net.js?v=5.3"></script>
    <script type="module" src="../../games/chess/chess.js?v=5.3"></script>
    <script src="../../js/input.js?v=5.3"></script>
    <script src="../../js/remapUI.js?v=5.3"></script>
    <script src="../../js/perfHud.js?v=5.3"></script>
  
<!-- Auto-signal bootstrap: emits READY/ERROR to parent -->
<script>
(function(){
  if (window.__gg_autoSignalInstalled) return; window.__gg_autoSignalInstalled = true;
  function post(type, payload){ try { parent && parent.postMessage(Object.assign({type}, payload||{}), "*"); } catch(e){} }
  window.addEventListener("error", e => post("GAME_ERROR", { error: (e.message || String(e.error || e)).slice(0,500) }));
  window.addEventListener("unhandledrejection", e => {
    const r = e && e.reason ? (e.reason.message || String(e.reason)) : "unhandled rejection";
    post("GAME_ERROR", { error: String(r).slice(0,500) });
  });
  function ready(){ post("GAME_READY"); }
  if (document.readyState === "complete") setTimeout(ready, 0);
  else window.addEventListener("load", () => setTimeout(ready, 0));
})();
</script>
</body>
</html>
