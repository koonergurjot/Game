<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gurjot's Games</title>
  <meta name="description" content="A tiny arcade hub with multiple games. Click a tile to play." />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <div class="brand">ðŸŽ® Gurjot's Games</div>
    <div class="hint">Click a game to play â€¢ Add more by copying a folder in <code>/games</code></div>
  </header>
  <main>
    <section class="grid">
      <a class="card" href="./games/box3d/" aria-label="Play 3D Box Playground" data-badge="3D">
        <h3>3D Box Playground</h3>
        <p>WASD + Space to jump. Orbit the camera with your mouse.</p>
        <div class="play">Play â†’</div>
      </a>
      <a class="card" href="./games/pong/" aria-label="Play Pong Classic" data-badge="2D">
        <h3>Pong Classic</h3>
        <p>Arrow keys to move. Keep the ball in play, beat the AI.</p>
        <div class="play">Play â†’</div>
      </a>
      <a class="card" href="./games/runner/" aria-label="Play Endless Runner">
        <div class="badge">2D</div>
        <h3>Endless Runner</h3>
        <p>Space to jump â€¢ Dodge obstacles â€¢ Compete for a high score.</p>
        <div class="play">Play â†’</div>
      </a>
      <a class="card" href="./games/asteroids/" aria-label="Play Asteroids" data-badge="2D">
        <h3>Asteroids</h3>
        <p>Rotate, thrust, and shoot to clear the field.</p>
        <div class="play">Play â†’</div>
      </a>
      <a class="card" href="./games/shooter/" aria-label="Play Space Shooter" data-badge="2D">
        <h3>Space Shooter</h3>
        <p>WASD to move, mouse to aim. Survive waves of enemies.</p>
        <div class="play">Play â†’</div>
      </a>
      <a class="card" href="./games/platformer/" aria-label="Play Retro Platformer" data-badge="2D">
        <h3>Retro Platformer</h3>
        <p>Run and jump through classic levels to reach the goal.</p>
        <div class="play">Play â†’</div>
      </a>
      <a class="card" href="./games/maze3d/" aria-label="Play 3D Maze Explorer" data-badge="3D">
        <h3>3D Maze Explorer</h3>
        <p>Navigate a 3D labyrinth and find the exit.</p>
        <div class="play">Play â†’</div>
      </a>
      </section>
  </main>
  <footer>Static, framework-free. Host anywhere (GitHub Pages ready).</footer>
  <script>
    let savedFilters = [];
    try {
      const raw = localStorage.getItem('hub:filters');
      if (raw) {
        savedFilters = JSON.parse(raw);
        if (!Array.isArray(savedFilters)) {
          savedFilters = [];
        }
      }
    } catch {
      savedFilters = [];
      localStorage.removeItem('hub:filters');
    }

    fetch('games.json')
      .then(r => r.json())
      .then(games => {
        const grid = document.querySelector('.grid');
        if (!grid) return;
        grid.innerHTML = '';
        for (const g of games) {
          if (savedFilters.length && !g.tags?.some(t => savedFilters.includes(t))) {
            continue;
          }
          const a = document.createElement('a');
          a.className = 'card';

          const url = new URL(g.path, location.href);
          const isNew = url.searchParams.get('new') === 'true';
          url.search = '';
          a.href = url.toString();
          a.dataset.badge = g.badge;
          a.setAttribute('aria-label', `Play ${g.title}`);

          if (g.thumb) {
            const img = document.createElement('img');
            img.className = 'thumb';
            img.src = g.thumb;
            img.alt = g.title;
            img.loading = 'lazy';
            img.onerror = () => img.remove();
            a.appendChild(img);
          }

          const h3 = document.createElement('h3');
          h3.textContent = g.title;
          a.appendChild(h3);

          const p = document.createElement('p');
          p.textContent = g.blurb;
          a.appendChild(p);

          const tagWrap = document.createElement('div');
          tagWrap.className = 'tags';
          g.tags?.forEach(t => {
            const span = document.createElement('span');
            span.textContent = t;
            tagWrap.appendChild(span);
          });
          a.appendChild(tagWrap);

          const score = localStorage.getItem('highscore:' + g.slug);
          const time = localStorage.getItem('besttime:' + g.slug);
          if (score || time) {
            const best = document.createElement('div');
            best.className = 'best';
            best.textContent = 'Best: ' + (score ?? `${time}s`);
            a.appendChild(best);
          }

          if (isNew) {
            const ribbon = document.createElement('div');
            ribbon.className = 'ribbon';
            ribbon.textContent = 'NEW';
            a.appendChild(ribbon);
          }

          const play = document.createElement('div');
          play.className = 'play';
          play.textContent = 'Play â†’';
          a.appendChild(play);

          grid.appendChild(a);
        }
      })
      .catch(err => {
        console.warn('Failed to load games.json', err);
      });
  </script>
</body>
</html>
